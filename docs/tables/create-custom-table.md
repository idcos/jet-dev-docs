---
sidebar_position: 1
sidebar_label: '自定义逻辑表'
---
# 自定义逻辑表

JET 中的列表因为和数据表强关联，所以可以比较准确地等同于数据库中的表。列表就是 JET 数据库表在业务的体现。该列表的列与表中的字段一一对应，通常表单上显示的字段就是一个数据表字段。

JET 中的列表都有一个显示名和一个名称，显示名可以包含空格和其他不允许出现在表名中的字符。同样的，表中的字段也有一个显示名和一个字段名。字段名和名称一定是唯一的，一般更难记忆，但更具体。例如：列表显示名Task可以指基本任务表、问题任务表、目录任务表等，而列表名称basic_task更具体且唯一。

## 创建表

大部分应用开发情况下，我们最先做的步骤是通过创建一个新表来存储我们的数据。在本例中，我们正在创建一个 *Virtual War Room* 应用程序，因此我们将创建一个表来保存 *Virtual War Room* 的信息。

首先，在 JET 导航器中，导航到系统定义 | 逻辑表，您将在其中看到逻辑表的列表视图。

单击逻辑表表右上角的绿色新增按钮开始。

![逻辑表按钮](/img/tables/create-button.jpg)

在新建逻辑表的显示名表单项中输入**Virtual War Room**，名称表单项会自动填充**u_virtual_war_room**，其中**u_**表示是一个用户自定义，非 JET 内置的逻辑表。当然在应用中自定义不带**u_**的逻辑表也是可以的。

![逻辑表创建](/img/tables/create-info.jpg)

#### 命名规范

显示名及名称命名偏向单数名词是较好的命名规范，例如**Virtual War Room**和**Virtual War Rooms**。JET 内置的大多数逻辑表也遵循这个命名规范，除了系统属性表(**sys_properties**)。系统属性表代指导航菜单和列表的属性所有合集，强调复数化的名词所以使用复数命名。所以当业务需要，也可以使用复数化名词命名。

#### 继承表

在继承表字段中，我们需先明确业务上该数据模型是否期望继承其他模型（继承某些字段、标签或者业务逻辑）。在**Virtual War Room**表中，我们需要继承 JET 中内置的任务（**task**）表的字段，所以继承表选择了**任务表[task]**。如果选择列表过长难以选择，可以在继承表的表单文本框输入表名称关键字（**task**）进行筛选。

#### 任务表

有多个显示名为**任务**的表，但只有一个名称为**task**的表。例如目录任务表，名称为**sc_task**。想了解更多关于任务表的信息，可以在[任务与工作流中](/docs/category/任务与工作流)中找到。

#### 应用菜单

如果我们想给新的应用创建一个新菜单和模块，我们可以选中应用菜单和模块各新增一条数据。在模块中填写新建表单项时，我们将表单项**链接类型**设置为**新增记录**，并在该字段下方，将表单项**表名**设置为与我们上述表相同的**Virtual War Room**。

![应用菜单](/img/tables/application-menu.jpg)

#### 列设置

你会注意到**列设置**选项卡及其列表部分，当前列表数据为空。我们暂时不考虑这部分，因为当我们填写了并保存该表记录，这些列的字段就会自动填充，并在字典管理中也新增相关记录。

新建新表后，如果您返回“列设置”部分，您会注意到自动出现了大约 60-70 个新列！其中一些是在所有表上都有的默认字段（如sys_created_on、sys_updated_on、sys_id等字段），但您看到的绝大多数字段都来自父表Task：
![列控制](/img/tables/task-field.jpg)
默认情况下，您会看到列设置列表显示了几个字段：显示名、类型、引用表、最大长度、默认值和是否作为引用展示。这些是相当常用的，以下是它每一项的含义：

- 显示名：这是列的展示名称（也是逻辑表上的​​字段展示名）
- 类型：这决定了该字段的类型。也规定了默认的最大长度（您也可以在最长长度处单独更改）、可用的字段属性和字段特性，以及可以填入的值类型。创建后更改字段类型非常困难，不建议用户频繁更改，因为更改类型会导致丢失现所有记录的该字段数据。所以在选择数据类型时要慎重考虑！
- 引用表：此字段仅与引用表上记录的某些类型的列相关。想了解更多，可以查阅[数据和关系](/docs/category/数据与关系)中的引用字段类型。
- 最大长度：这是该字段将接受的最大长度（以字符为单位）。对于绝大多数数据类型，最大长度默认值为40，而引用类型的默认最大长度是32，因为这是sys_id（数据库中单个记录的唯一标识符）就是32位，而多行文本类型是4000，等等。
  - 您可以在此处指定您喜欢的任何长度，但需要注意的是，字段最大长度越长，在查询、保存或删除该表中的记录时性能就越差。

  - 如果该字段所在的表继承了另一个表，那么父表的性能也会受到影响！所以最好不要在继承的表上创建太多额外的字段，尤其注意不要和其他继承表冗余；尤其是长字段。
- 默认值：这是字段的默认值，在用户传入值之前使用，或者新增记录时，该字段无值，则会被填充默认值。
- 是否作为引用展示：每个表只能有一个引用展示。引用展示值是展示的单个字段，以表示整个记录。例如，在事件表上，引用展示值为编号字段，但有些公司会将引用展示值更改为简介。在用户表中，您可能想把用户编号或用户名作为引用展示值。

在这个章节中，您已经了解了很多关于列和字段的术语解释，但请注意这两个名词概念，在此文描述的这些情况下是等同的。即，逻辑表中的列即是数据表中的字段。

#### 表控制

![表控制](/img/tables/control.jpg)

- 可继承：这表示其他表能够继承该表。如果我们正在创建一个父表，该表的子表需要共享我们创建的自定义字段，该功能很常用，但这个场景下，我们不勾选此功能。
- 创建访问控制：这允许您配置该表的访问控制，并选择（或创建）一个角色来控制对应用程序的访问。业务上经常有角色/组的权限管理场景，这个**Virtual War Room**的场景也不例外，所以请在这里勾选，并选中一个可访问角色。下方的用户角色字段允许我们选择现有角色。
- 有关角色和安全性的信息，请参阅[用户管理和安全](/docs/category/用户管理与安全)。

## 添加字段

现在已经有了一个表，继续往我们的Virtual War Room表中添加一些额外的字段。为此，我们有两个操作选择。

选择1 是我们可以滚动到列表底，并点击添加新行，填写好必要的值即可完成添加字段。
![添加字段](/img/tables/add-field.jpg)
我们添加字段没有填写的配置都会被设置成其配置的默认值，无默认值的就为空。这个选择唯一不好的点是，它不允许你在添加字段时查看和编辑所有相关的字段配置，它只能查看和编辑当前已展示的这些字段配置。

选择2 是在导航字典管理中点击"新增"按钮。这将导航到Dictionary表（所有表和列定义都存储在此）的新增记录表单页面。这个表单本身有许多内置逻辑，所以仅会展示与创建内容相关的表单字段。
<!-- TODO: *上述 选择2 的内置逻辑暂时待完善中，完善后按需新增文档* -->

<!-- 首先，让我们创建一个体现特殊事件的引用展示字段，用于排序和区别已有的事件。
![添加字段](/img/tables/add-field-dictionary.jpg)

1. 请在上示表的表单项中，选中Virtual War Room表。
2. Major incident -->

## 逻辑表视图

在应用程序导航器中过滤文本框，输入u_virtual_war_room_list.do，您将看到Virtual War Room列表视图。

在表的列表视图中显示的列，可以是个性化配置的（仅为当前用户修改）或默认配置的（为所有用户修改）。您可以选择在列表视图中显示表中的任何字段，甚至可以选择继承字段（包含来自相关记录的数据的字段）。

如果您主要事件字段在Virtual War Room列表视图中看不到该列，请单击列表视图的左上角的齿轮按钮。在标记为可选择字段的列表中找到主要事件字段，然后选择它，然后单击右箭头将其移至已选择字段框。
![视图字段选择](/img/tables/selected.jpg)

接下来，确保您选择了该字段并单击右侧的向上箭头，直到它出现在指派人列之后。

当我们在当前界面时，我们也可以删除一些多余的列。通过在已选择字段框中选中配置项字段并点击左箭头，让它们移回可选择字段。然后保存即可。

还有一点值得注意的是此处的视图调整仅针对当前用户，其他用户是无法感知的。

至此，您已完成了在自定义表上创建了第一个自定义字段。

## 逻辑表查询

<!-- TODO: 列表过滤器现在还没像serviceNow的那么复杂，目前的逻辑比较轻量。后续补齐后再迭代文档 -->

列表视图的另一个主要组成部分是条件过滤器，他们可以通过特定的字段进行筛选，并且条件可叠加。可以在左侧选择表字段后，右侧文本框填入筛选值，最后点击放大镜图标进行保存筛选条件并自动筛选。

![逻辑表查询](/img/tables/filter.jpg)
