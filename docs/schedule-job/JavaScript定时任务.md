---
sidebar_position: 1
sidebar_label: 'JavaScript定时任务'
---
  让我们从创建JavaScript定时任务记录开始。按照以下步骤在我们的应用程序中创建一条记录，我们可以使用它来设置在某一时间执行设置好的JavaScript脚本：
## 在开始之前
你所需要的角色：admin 或 schedule_admin

## 关于这个任务
以下是条件脚本的示例。仅当存在超过 30 天的活动事件时，它才会运行计划作业。

```` 示例
// Only run this Scheduled Job if there are active Incidents over 30 days old
var ga = new GlideAggregate('incident');
ga.addAggregate('COUNT');
ga.addQuery('active', 'true');
ga.addQuery('sys_created_on', '<', gs.daysAgo(30));
ga.query();
ga.next();
ga.getAggregate('COUNT') !== '0'
````

## 步骤
1. 菜单栏 > 系统定义 > 计划作业
2. 点击**新建**。
3. 选择自动运行您选择的脚本。
4. 在表格上，填写字段。

## 脚本执行信息
| **字段** |             **描述**                                     |
|---|------------------------------------------------------------|
| 名称 | 标识此计划作业的名称|
| 活动 | 指示计划作业处于活动状态并应在指定日期和时间执行的选项|
| 应用 | 包含脚本的应用程序的名称。 如果脚本在全局范围内，则显示全局 |
| 有条件的 | 如果在相关脚本中满足某些条件，则启用运行计划作业的选项 |
| 健康）状况 | 确定是否应运行计划作业的条件脚本。脚本的最后一个表达式应计算为布尔 (true/false) 值。仅当您选择Conditional时才会出现此文本框 。警告：计划报告电子邮件和性能分析数据收集作业的条件脚本在沙箱中执行。因此，函数定义是不允许的。某些 API 调用和关键字也是不允许的。有关详细信息，请参阅脚本沙盒属性。升级后，带有包含这些不允许的 API 组件的条件脚本的作业将以“已收集错误”结束。 |
| 执行策略 | 用于运行计划作业的时间间隔：Daily：每天在指定时间运行。每周：每周在一周中的指定时间和日期运行。每月：每月在指定的时间和日期运行。定期：以指定的重复间隔运行。一次：仅运行一次。按需：按需立即运行。业务日历：条目开始：在您在业务日历字段中选择的业务日历的开始条目日期运行。计划作业在您为业务日历定义的每个业务条目的开始日期运行。例如，如果业务日历代表一个会计年度，并且每个条目的开始日期是一个会计月，则计划作业在每个月的第一天运行。业务日历：条目结束：在您在业务日历 字段中选择的业务日历的结束日期运行。此选择以与Business Calendar: Entry Start相同的方式运行，但针对关联的业务日历条目的结束日期。笔记：当您选择业务日历：条目开始 或业务日历：条目结束时，您可以应用偏移因子来安排作业在所选业务日历的时间跨度之前或之后运行。要了解更多信息，请参阅偏移类型和 偏移字段。要了解有关创建和使用业务日历以及定义业务日历条目的更多信息，请参阅 创建业务日历和定义业务日历条目。|
| 天 | 计划作业应运行的日期。如果Run设置为Weekly，请选择星期几。例如，选择星期三。如果Run设置为Monthly，请选择月份中的哪一天。例如，选择 25 作为该月的第 25 天。仅当您在运行字段中选择每月或 每周时，此字段才会出现。|
| 重复间隔 | 每个计划的作业执行的重复间隔的持续时间。以天数、小时数或分钟数输入持续时间。例如：要每四天运行一次计划作业，请输入04 天数字段。要每 26 小时运行一次，请输入26“ 小时”字段。如果它应该以 13:30:25 的间隔重复，请输入 13Hours字段，然后30输入25其后面的两个未标记字段。 |
| 开始 | 第一次计划作业生成的日期和时间。选择日历日期和时间。仅当您在运行字段中选择定期时，此字段才会出现 。|
| 商务日历 | 用于确定计划作业的业务日历开始或结束日期的业务日历条目。仅当您在时间字段中选择业务 条目：开始日期或业务条目：结束日期时，才会出现此字段。 |
| 偏移类型 | 时间偏移类型（如果有）应用于您选择用于安排此作业的业务日历。过去：应用偏移因子来安排作业在所选业务日历的时间跨度开始之前运行。未来：应用偏移因子来安排作业在所选业务日历的时间跨度结束后运行。--None--：调度此作业时不应用时间偏移。添加偏移因子可以将作业安排在业务日历中为以下用例定义的正式时间跨度之前或之后运行：在所选业务日历的时间跨度之外的特定时间安排工作。安排多个作业在所选业务日历的时间跨度内按顺序运行。仅当您在运行字段中选择业务日历：条目开始或业务日历：条目结束时， 才会出现偏移类型和偏移字段。|
| 抵消 | 时间偏移量，以天、小时、分钟和秒表示，应用于您选择用于安排此作业的业务日历。例如，如果您想安排作业在业务日历开始日期前三天 14 小时 10 分钟 45 秒开始：在偏移类型字段中选择过去。在天数字段中输入3 。在小时字段中输入14、10和 45 。仅当您在运行字段中选择业务日历：条目开始或业务日历：条目结束，在偏移类型字段中选择过去或 未来时，偏移天数和小时 字段才会出现 。 |
| 作为 [可选] 运行 | 选择另一个用户来运行脚本执行。配置表单以添加此字段（如果不存在）。 |
| 运行此脚本 | 在计划的日期和时间运行的脚本的名称。例如，从业务规则中复制脚本逻辑，或调用脚本包含。|

5、单击更新以更新计划作业，单击立即执行以立即执行计划脚本，或 单击删除以删除作业。


 



