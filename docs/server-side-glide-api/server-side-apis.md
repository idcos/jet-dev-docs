---
sidebar_position: 2
sidebar_label: 'structure-api-class'
---
# 服务端API

就像在客户端上一样，脚本在服务器上执行具有他们有权访问的特定 API 集。服务器端 API 套件比客户端 API 更广泛，因为在客户端上提供 API 需要将代码从服务器发送到客户端，这会减慢页面加载时间。服务器与数据库的连接延迟极低，这使得更健壮的脚本编写成为可能并且效率更高。

## Tip

有两组 API：scoped和legacy。范围 API 是主要是遗留API的一个子集。它们是作用域应用程序中唯一可用的 API，并且确实有一些限制。然而，这些限制正变得越来越少对于JET的每个新版本。您可能在 JET中执行的大部分操作都将在全局范围内，因此您无需*过多*担心这种差异。

让我们简要看一下服务器上可用的一些 API 和对象：
- **GlideAggregate**：这是一个的扩展GlideRecord 类，用于创建数据库聚合查询，如`SUM`、`COUNT`、`MIN`和`MAX`。例如，您可以使用给定过滤器（例如，与给定工单关联的所有项目）运行查询，并获取`SUM`这些项目的成本以确定父工单的总成本。 -- 待实现
- **GlideDateTime**：这是一个类旨在帮助使用`glide_date_time`字段，以及比较一个日期和时间另一个日期和时间，或将日期/时间从字符串格式化为可用于时区转换和日期/时间计算的日期/时间对象。-- 待实现
- **GlideDate**：这是非常类似于`GlideDateTime`类，但是是仅适用于没有时间关联的日期。-- 待实现
- **GlideRecord**：这是可能是JET中使用最普遍的类，它既是服务器端 API，也是客户端 API。它在客户端上的行为和功能有很大不同，但在服务器上，它是一种强大而有效的方法，可以查询数据库以获取给定的结果或结果集。您可以想象，在像 JET这样的平台中，您可能需要经常在数据库中获取和设置数据。
- **GlideElement**：这是一个类引用客户端 GlideRecord 对象上的特定字段。一个GlideRecord 对象上的每个字段的属性都包含了一个 **GlideElement** 对象。此 API 提供了与这些字段及其值进行交互的方法。
- **gs**：这是一个对 GlideSystem 的引用（它没有构造方法）。它提供具有各种有用系统功能的方法，包括获取系统属性、将信息记录到系统日志以及检查用户权限。

  ### Tip

  准备实例化的对象具有构造函数方法。必须使用new关键字调用此方法。在我写`var gr = new GlideRecord('table_name');`的时候，new关键字调用了GlideRecord类的构造方法。这个构造函数通常是类中的一个名为 initialize 的函数，或者构造对象的构造函数是隐式的无参构造，它接受了指定的参数table_name。然后构造函数修改对象的属性并将生成的构造对象返回给我们的变量（比如在这个例子中返回的对象`gr` ）。

- **GlideSession**：这是一个对应的服务器端对象当前登录用户的会话。它提供了获取与用户关联的角色以及设置和检索与其特定会话关联的数据的方法。您可以使用GlideSystem API的方法`getSession()`获取当前用户会话的 GlideSession 对象的实例，如下所示：

  ```
  var userSession = gs.getSession();
  ```

对特定记录（例如业务规则或高级条件字段）进行操作的服务器端脚本通常也可以访问名为`current`. 这是 GlideRecord 对象的一个实例，其中包含脚本正在执行的记录（或者我们应该说：触发脚本运行的记录）。

例如，假设您有一个在**项目** [ `project`] 表上执行的业务规则，规定项目表新增数据时，就会触发业务规则。在执行业务规则的脚本代码中，该`current`对象将对应于您刚刚新增的那条记录。

![新增项目业务规则](/img/business-rules/add-project-business-rules.png)